#!/usr/bin/env python3
import sys


OBF = None
KEY = b"moxiebox"


def mod95(x: int) -> int:
    return x % 95


def deobfuscate(s: str) -> str:
    inv12 = 8  # 12*8 == 96 == 1 (mod 95)
    prev = 17
    out = []
    for i, ch in enumerate(s.encode("ascii")):
        y = ch - 32
        t = mod95(inv12 * (y - ((i * 7 + 13) % 95)))
        x = mod95(t - KEY[i % len(KEY)] - prev)
        out.append(x + 32)
        prev = y
    return bytes(out).decode("ascii")


def main() -> int:
    global OBF
    if len(sys.argv) == 2:
        OBF = sys.argv[1]
    else:
        print(f"usage: {sys.argv[0]} '<obfuscated_string>'", file=sys.stderr)
        return 2
    print(deobfuscate(OBF))
    return 0


if __name__ == "__main__":
    raise SystemExit(main())
